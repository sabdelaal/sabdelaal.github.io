<!DOCTYPE html> <html lang="en-US"> <head prefix="og: http://ogp.me/ns#"> <!-- TODO only add social media tags when keys are present! --> <meta charset="UTF-8" /> <meta http-equiv="X-UA-Compatible" content="ie=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <meta name="mobile-web-app-capable" content="yes" /> <meta name="apple-mobile-web-app-capable" content="yes" /> <meta name="application-name" content="Safwan Abdel Aal" /> <meta name="apple-mobile-web-app-status-bar-style" content="#fff" /> <meta name="apple-mobile-web-app-title" content="Safwan Abdel Aal" /> <title> Authentication with ReactJS and GraphQL via JsonWebToken - Safwan Abdel Aal </title> <link rel="alternate" href="http://localhost:4000/projects/react-graphql-auth" hreflang="en-US" /> <link rel="canonical" href="http://localhost:4000/projects/react-graphql-auth" /> <meta name="description" content="learning by doing" /> <meta name="referrer" content="no-referrer-when-downgrade" /><meta property="og:site_name" content="Authentication with ReactJS and GraphQL via JsonWebToken | Safwan Abdel Aal" /> <meta property="og:title" content="Authentication with ReactJS and GraphQL via JsonWebToken | Safwan Abdel Aal" /> <meta property="og:type" content="website" /> <meta property="og:url" content="http://localhost:4000/projects/react-graphql-auth" /> <meta property="og:description" content="learning by doing" /> <meta property="og:image" content="" /> <meta property="og:image:width" content="640" /> <meta property="og:image:height" content="640" /> <meta name="twitter:card" content="summary" /> <meta name="twitter:title" content="Authentication with ReactJS and GraphQL via JsonWebToken | " /> <meta name="twitter:url" content="http://localhost:4000/projects/react-graphql-auth" /> <meta name="twitter:site" content="@" /> <meta name="twitter:creator" content="@" /> <meta name="twitter:description" content="learning by doing" /> <meta name="twitter:image" content="" /> <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Safwan Abdel Aal" /> <!-- TODO make it available on mobile <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicons/apple-touch-icon.png" /> <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png" /> <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png" /> <link rel="manifest" href="/assets/favicons/site.webmanifest" /> <link rel="mask-icon" href="/assets/favicons/safari-pinned-tab.svg" color="#5bbad5" /> --> <meta name="msapplication-TileColor" content="#da532c" /> <meta name="theme-color" content="#2c2c2c" /> <link rel="stylesheet" href="/assets/css/style.css" /></head> <body data-theme="light" class="notransition"> <script> const body = document.body; const setUtterancesTheme = theme => { const utterances = document.querySelector('.utterances-frame'); if (!utterances) return; utterances.contentWindow.postMessage( {type: 'set-theme', theme: `github-${theme}`}, 'https://utteranc.es', ); }; const setMixcloudTheme = theme => { const oldTheme = theme == 'light' ? 'dark' : 'light'; const selection = document.getElementsByTagName('iframe'); const iframes = Array.prototype.slice.call(selection); iframes.forEach(iframe => { if (!iframe.src.match(/mixcloud/g)) { return; } iframe.setAttribute('src', iframe.src.replace(oldTheme, theme)); }); }; const initTheme = theme => { if (!theme) theme = body.getAttribute('data-theme'); localStorage.setItem('theme', theme); body.setAttribute('data-theme', theme); setUtterancesTheme(theme); setMixcloudTheme(theme); }; window.initTheme = initTheme; initTheme(localStorage.getItem("theme")); setTimeout(() => body.classList.remove("notransition"), 75); addEventListener('message', event => { if (event.origin !== 'https://utteranc.es') return; setUtterancesTheme(localStorage.getItem("theme")); }); </script> <div class="navbar" role="navigation"> <nav class="menu"> <input type="checkbox" id="menu-trigger" class="menu-trigger" /> <label for="menu-trigger"> <span class="menu-icon"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <path d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z" /> </svg> </span> </label> <a id="mode"> <svg class="mode-sunny" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>LIGHT</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> <svg class="mode-moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>DARK</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> </a> <div class="title"> <a class="menu-link active" href="http://localhost:4000">Safwan Abdel Aal</a> </div> <div class="trigger"> <div class="trigger-container"><a class="menu-link" href="/">blog</a><a class="menu-link" href="/about">about</a><a class="menu-link" href="/music">music</a><a class="menu-link" href="/ideas">ideas</a><a class="menu-link rss" href="/feed.xml"> <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 512 512" fill="#ED812E" > <title>RSS</title> <path d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z" /> <path d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z" /> <path d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z" /> </svg> </a> </div> </div> </nav> </div> <div class="wrapper post"> <main class="page-content" aria-label="Content"> <article itemscope itemtype="https://schema.org/BlogPosting"> <header class="header"> <h1 class="header-title" itemprop="headline">Authentication with ReactJS and GraphQL via JsonWebToken</h1> <div class="post-meta"> <time datetime="2018-06-09T00:15:00+03:00" itemprop="datePublished"> Jun 08, 2018 </time> <span itemprop="author" itemscope itemtype="https://schema.org/Person"> <span itemprop="name">Safwan Abdel Aal</span> </span> <time hidden datetime="" itemprop="dateModified"> Jun 08, 2018 </time> <span hidden itemprop="publisher" itemtype="Person">Safwan Abdel Aal</span> <span hidden itemprop="image"></span> <span hidden itemprop="mainEntityOfPage"></span> </div> </header> <div class="page-content" itemprop="articleBody"> <p>This project is about me learning a Javascript framework called <a href="https://reactjs.org">React</a> and <a href="https://graphql.org">GraphQL</a>. Like always, it’s easier to learn new stuff when applying it to a project.<br /> I decided to create a simple authentication system.</p> <p>The theme is made with <a href="https://bulma.io">Bulma.io</a> because I wanted to try out a popular alternitive to <a href="https://getbootstrap.com">Bootstrap</a>. The docmentation for Bulma is also really good.</p> <p>For saving the login credentials I used <a href="https://github.com/auth0/node-jsonwebtoken">jsonwebtoken</a>.</p> <p><a href="https://github.com/scriptworld-git/react-graphql-authentication">Click here</a> to see the code on GitHub.</p> <h2 id="database"> <a href="#database" class="anchor-head"></a> Database </h2> <p>To store all the user data I use a simple json file based database called <a href="https://github.com/typicode/lowdb">lowdb</a>. I didn’t want to install a local DB only for a little project.<br /> Even though I implemented all database actions in a seperate class. It would be kinda easy to refactor the database to MySQL only by changing this class. All other code still behave the same.</p> <p>Passwords are also stored in a hashed format to increase security. This is done via <a href="https://www.npmjs.com/package/bcrypt">bcrypt</a>.</p> <h3 id="class-snippet"> <a href="#class-snippet" class="anchor-head"></a> Class snippet </h3> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">low</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">lowdb</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">FileSync</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">lowdb/adapters/FileSync</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">adapter</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FileSync</span><span class="p">(</span><span class="dl">'</span><span class="s1">./databaseUser.json</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">userLow</span> <span class="o">=</span> <span class="nf">low</span><span class="p">(</span><span class="nx">adapter</span><span class="p">);</span>

<span class="nx">userLow</span><span class="p">.</span><span class="nf">defaults</span><span class="p">({</span> <span class="na">users</span><span class="p">:</span> <span class="p">[]</span> <span class="p">}).</span><span class="nf">write</span><span class="p">();</span>

<span class="kd">class</span> <span class="nc">userDB</span> <span class="p">{</span>
    <span class="k">async</span> <span class="nf">getUserByEmail</span><span class="p">(</span><span class="nx">email</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">userLow</span>
            <span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">users</span><span class="dl">'</span><span class="p">)</span>
            <span class="p">.</span><span class="nf">find</span><span class="p">({</span> <span class="nx">email</span> <span class="p">})</span>
            <span class="p">.</span><span class="nf">value</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">async</span> <span class="nf">updateToken</span><span class="p">(</span><span class="nx">username</span><span class="p">,</span> <span class="nx">token</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">userLow</span>
            <span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="dl">'</span><span class="s1">users</span><span class="dl">'</span><span class="p">)</span>
            <span class="p">.</span><span class="nf">find</span><span class="p">({</span> <span class="nx">username</span> <span class="p">})</span>
            <span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="dl">'</span><span class="s1">iat</span><span class="dl">'</span><span class="p">,</span> <span class="nx">jwt</span><span class="p">.</span><span class="nf">decode</span><span class="p">(</span><span class="nx">token</span><span class="p">).</span><span class="nx">iat</span><span class="p">)</span>
            <span class="p">.</span><span class="nf">write</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="file-preview"> <a href="#file-preview" class="anchor-head"></a> File preview </h3> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"users"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"password"</span><span class="p">:</span><span class="w">
                </span><span class="s2">"$2b$10$L72HnDgRvpS9N87iuTdZcewJMNmNFeep21HCgnFU0hv6b/FoXI36."</span><span class="p">,</span><span class="w">
            </span><span class="nl">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test@test.de"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"iat"</span><span class="p">:</span><span class="w"> </span><span class="mi">1528578690</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <h2 id="api"> <a href="#api" class="anchor-head"></a> API </h2> <p>While searching the web for an alternative to Axios with Express, I learned about GraphQL. This API should fit nice into React.<br /> At the beginning it was kinda hard to learn, because it works really different to other API’s out there.</p> <p>After setting my application up for handling GraphQL, the steps were gettin easier and faster along the way. Implementing more and more requests were faster after the core work was done.</p> <h3 id="graphql-snippet"> <a href="#graphql-snippet" class="anchor-head"></a> GraphQL snippet </h3> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">typeDef</span> <span class="o">=</span> <span class="nx">gql</span><span class="s2">`
    type User {
        username: String
        email: String
        jwt: String
    }
    type Mutation {
        usernameExists(username: String!): Boolean
        emailExists(email: String!): Boolean
        passwordCorrect(username: String!, password: String!): Boolean
        login(username: String!, password: String!): User
        signup(username: String!, email: String!, password: String!): Boolean
        verifyToken(token: String!): User
    }
`</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">resolver</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">Mutation</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">usernameExists</span><span class="p">:</span> <span class="k">async </span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="p">{</span> <span class="nx">username</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">await</span> <span class="nf">checkUsername</span><span class="p">(</span><span class="nx">username</span><span class="p">);</span>
        <span class="p">},</span>
        <span class="na">emailExists</span><span class="p">:</span> <span class="k">async </span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="p">{</span> <span class="nx">email</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">await</span> <span class="nx">userDB</span><span class="p">.</span><span class="nf">getUserByEmail</span><span class="p">(</span><span class="nx">email</span><span class="p">);</span>
        <span class="p">},</span>
        <span class="na">passwordCorrect</span><span class="p">:</span> <span class="k">async </span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="p">{</span> <span class="nx">username</span><span class="p">,</span> <span class="nx">password</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">await</span> <span class="nf">checkPassword</span><span class="p">(</span><span class="nx">username</span><span class="p">,</span> <span class="nx">password</span><span class="p">);</span>
        <span class="p">},</span>
        <span class="na">login</span><span class="p">:</span> <span class="k">async </span><span class="p">(</span><span class="nx">root</span><span class="p">,</span> <span class="p">{</span> <span class="nx">username</span><span class="p">,</span> <span class="nx">password</span> <span class="p">},</span> <span class="nx">context</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="k">await</span> <span class="nf">checkUsername</span><span class="p">(</span><span class="nx">username</span><span class="p">);</span>

            <span class="k">if </span><span class="p">(</span><span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">const</span> <span class="nx">checkedPassword</span> <span class="o">=</span> <span class="k">await</span> <span class="nf">checkPassword</span><span class="p">(</span><span class="nx">username</span><span class="p">,</span> <span class="nx">password</span><span class="p">);</span>
                <span class="k">if </span><span class="p">(</span><span class="nx">checkedPassword</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">const</span> <span class="nx">token</span> <span class="o">=</span> <span class="nx">jwt</span><span class="p">.</span><span class="nf">sign</span><span class="p">(</span>
                        <span class="p">{</span>
                            <span class="nx">username</span>
                        <span class="p">},</span>
                        <span class="nx">config</span><span class="p">.</span><span class="nx">jwtSecret</span>
                    <span class="p">);</span>

                    <span class="kd">const</span> <span class="nx">u</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">userDB</span><span class="p">.</span><span class="nf">updateToken</span><span class="p">(</span><span class="nx">username</span><span class="p">,</span> <span class="nx">token</span><span class="p">);</span>

                    <span class="k">return</span> <span class="p">{</span> <span class="na">username</span><span class="p">:</span> <span class="nx">u</span><span class="p">.</span><span class="nx">username</span><span class="p">,</span> <span class="na">email</span><span class="p">:</span> <span class="nx">u</span><span class="p">.</span><span class="nx">email</span><span class="p">,</span> <span class="na">jwt</span><span class="p">:</span> <span class="nx">token</span> <span class="p">};</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nc">Error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Password is incorrect!</span><span class="dl">'</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">throw</span> <span class="k">new</span> <span class="nc">Error</span><span class="p">(</span><span class="dl">'</span><span class="s1">Username does not exist!</span><span class="dl">'</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="na">signup</span><span class="p">:</span> <span class="k">async </span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="p">{</span> <span class="nx">username</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">password</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">await</span> <span class="nx">userDB</span><span class="p">.</span><span class="nf">addUser</span><span class="p">(</span><span class="nx">username</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">password</span><span class="p">);</span>
        <span class="p">},</span>
        <span class="na">verifyToken</span><span class="p">:</span> <span class="k">async </span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="p">{</span> <span class="nx">token</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="kd">const</span> <span class="nx">decoded</span> <span class="o">=</span> <span class="nx">jwt</span><span class="p">.</span><span class="nf">decode</span><span class="p">(</span><span class="nx">token</span><span class="p">);</span>
                <span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">userDB</span><span class="p">.</span><span class="nf">getUser</span><span class="p">(</span><span class="nx">decoded</span><span class="p">.</span><span class="nx">username</span><span class="p">);</span>
                <span class="k">if </span><span class="p">(</span><span class="nx">user</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if </span><span class="p">(</span><span class="nx">user</span><span class="p">.</span><span class="nx">iat</span> <span class="o">===</span> <span class="nx">decoded</span><span class="p">.</span><span class="nx">iat</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">return</span> <span class="p">{</span> <span class="na">username</span><span class="p">:</span> <span class="nx">user</span><span class="p">.</span><span class="nx">username</span><span class="p">,</span> <span class="na">email</span><span class="p">:</span> <span class="nx">user</span><span class="p">.</span><span class="nx">email</span> <span class="p">};</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                        <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span> <span class="k">catch </span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div> <h2 id="state-management"> <a href="#state-management" class="anchor-head"></a> State Management </h2> <p>For state management of react applications many people use <a href="https://redux.js.org">ReduxJs</a>. I thought this is really complex because you have to pass everything to the props of your components. Sometimes this gets really annoying when adding some functions to your state.<br /> You always have to make sure to pass them correctly to every component which needs to access this function.</p> <p>After searching the web I learned about <a href="https://mobx.js.org">MobX</a>. I used Webpack to write ES6 code anyways, so I added another plugin to allow decorators in my javascript files. This function is really handy because MobX comes with alot of nice and easy to handly decorators.</p> <p>Every component which needs to access one specific state, just needs to get it inserted via decorators.<br /> In my opinion the code looks way cleaner and easier to read.</p> <h3 id="user-state-snippet"> <a href="#user-state-snippet" class="anchor-head"></a> User State snippet </h3> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">userStore</span> <span class="p">{</span>
    <span class="p">@</span><span class="nd">observable</span> <span class="nx">username</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
    <span class="p">@</span><span class="nd">observable</span> <span class="nx">email</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>

    <span class="p">@</span><span class="nd">observable</span> <span class="nx">isAuthenticated</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

    <span class="p">@</span><span class="nd">action</span>
    <span class="nf">login</span><span class="p">(</span><span class="nx">username</span><span class="p">,</span> <span class="nx">email</span><span class="p">,</span> <span class="nx">token</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">localStorage</span><span class="p">.</span><span class="nx">jwtToken</span> <span class="o">=</span> <span class="nx">token</span><span class="p">;</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">username</span> <span class="o">=</span> <span class="nx">username</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">email</span> <span class="o">=</span> <span class="nx">email</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">isAuthenticated</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="p">@</span><span class="nd">action</span>
    <span class="nf">logout</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if </span><span class="p">(</span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">jwtToken</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">delete</span> <span class="nx">localStorage</span><span class="p">.</span><span class="nx">jwtToken</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">this</span><span class="p">.</span><span class="nx">isAuthenticated</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">username</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">email</span> <span class="o">=</span> <span class="dl">''</span><span class="p">;</span>

        <span class="nx">client</span><span class="p">.</span><span class="nf">resetStore</span><span class="p">();</span>

        <span class="nx">history</span><span class="p">.</span><span class="nf">push</span><span class="p">(</span><span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="example-observer--injection"> <a href="#example-observer--injection" class="anchor-head"></a> Example observer / injection </h3> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">@</span><span class="nd">observer</span>
<span class="p">@</span><span class="nd">inject</span><span class="p">(</span><span class="dl">'</span><span class="s1">userStore</span><span class="dl">'</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">LoginHeader</span> <span class="kd">extends</span> <span class="nc">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
    <span class="nf">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
            <span class="na">username</span><span class="p">:</span> <span class="dl">''</span><span class="p">,</span>
            <span class="na">password</span><span class="p">:</span> <span class="dl">''</span><span class="p">,</span>
            <span class="na">isLoading</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="na">errorUsername</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="na">errorPassword</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="na">signup</span><span class="p">:</span> <span class="kc">false</span>
        <span class="p">};</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <h2 id="screenshots"> <a href="#screenshots" class="anchor-head"></a> Screenshots </h2> <h5 id="navbar"> Navbar </h5> <p><img src="/assets/react-graphql-auth/navbar.png" alt="navbar" /></p> <h5 id="logged-in"> Logged in </h5> <p><img src="/assets/react-graphql-auth/personal.png" alt="personal" /></p> <h5 id="signup-modal"> Signup modal </h5> <p><img src="/assets/react-graphql-auth/signup.png" alt="signup" /></p> </div> </article> </main> <footer class="footer"><a class="footer_item" href="https://github.com/sabdelaal" rel="noreferrer" target="_blank">github</a><a class="footer_item" href="https://www.linkedin.com/in/safwanabdelaal/" rel="noreferrer" target="_blank">linkedin</a><a class="footer_item" href="/archive">archive</a> <a class="footer_item" href="/tags">tags</a> <a class="footer_item" href="/feed.xml">rss</a> <span class="footer_item">&copy; 2024</span> </footer> <script src="/assets/js/main.js" defer="defer"></script> </div> </body> </html>
